{{- $qs := slice -}}
{{- range $key, $val := .query -}}
{{- if $val -}}
{{- $qs = $qs | append $key $val -}}
{{- end -}}
{{- end -}}

{{- $options := dict -}}
{{- with site.Params.GITLAB_API_KEY -}}
  {{- $options = merge $options (dict "Authorization" (printf "Bearer %s" .)) -}}
{{- end -}}

{{- $url := printf "https://gitlab.com/api/v4/%s?%s" .path (querify $qs) -}}
{{ return getJSON $url $options }}
